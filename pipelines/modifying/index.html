<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-pipelines/modifying" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Modifying a Pipeline While Preserving its State | Feldera Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.feldera.com/pipelines/modifying"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Modifying a Pipeline While Preserving its State | Feldera Documentation"><meta data-rh="true" name="description" content="This feature is only available in Feldera Enterprise Edition."><meta data-rh="true" property="og:description" content="This feature is only available in Feldera Enterprise Edition."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.feldera.com/pipelines/modifying"><link data-rh="true" rel="alternate" href="https://docs.feldera.com/pipelines/modifying" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.feldera.com/pipelines/modifying" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WX24466N8W-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Pipelines","item":"https://docs.feldera.com/pipelines/"},{"@type":"ListItem","position":2,"name":"Modifying a Pipeline","item":"https://docs.feldera.com/pipelines/modifying"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Feldera Documentation" href="/opensearch.xml">


<link rel="preconnect" href="https://us.i.posthog.com">
<script>!function(t,e){var o,s,r,a;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,n,p){function c(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(r=t.createElement("script")).type="text/javascript",r.async=!0,r.src=n.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(a=t.getElementsByTagName("script")[0]).parentNode.insertBefore(r,a);var g=e;for(void 0!==p?g=e[p]=[]:p="posthog",g.people=g.people||[],g.toString=function(t){var e="posthog";return"posthog"!==p&&(e+="."+p),t||(e+=" (stub)"),e},g.people.toString=function(){return g.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),s=0;s<o.length;s++)c(g,o[s]);e._i.push([i,n,p])},e.__SV=1)}(document,window.posthog||[]),posthog.init("phc_GKR68l5zo531AD1R3cnE3MCPEBPXTqgYax4q053LVBD",{api_host:"https://us.i.posthog.com",id:"default"})</script>
<script async defer="defer" id="hs-script-loader" src="//js.hs-scripts.com/45801078.js"></script><link rel="stylesheet" href="/assets/css/styles.6b0c5225.css">
<script src="/assets/js/runtime~main.8b603b93.js" defer="defer"></script>
<script src="/assets/js/main.d1146138.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.feldera.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo-color-dark.svg" alt="Feldera Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-color-light.svg" alt="Feldera Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/get-started">Get Started</a><a class="navbar__item navbar__link" href="/sql">SQL Reference</a><a class="navbar__item navbar__link" href="/connectors">Connectors</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://join.slack.com/t/felderacommunity/shared_invite/zt-222bq930h-dgsu5IEzAihHg8nQt~dHzA" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://discord.com/invite/s6t5n9UzHE" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/feldera/feldera" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">What is Feldera?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/architecture/enterprise">Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/get-started/">Install Feldera</a><button aria-label="Expand sidebar category &#x27;Install Feldera&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/tutorials/">Guides</a><button aria-label="Expand sidebar category &#x27;Guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/interface/">Feldera Interface</a><button aria-label="Collapse sidebar category &#x27;Feldera Interface&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interface/web-console">Web Console</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interface/cli">Command line tool (fda)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="/python/" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Python SDK<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="/api" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">REST API<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/pipelines/">Pipelines</a><button aria-label="Collapse sidebar category &#x27;Pipelines&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/sql/">Feldera SQL</a><button aria-label="Expand sidebar category &#x27;Feldera SQL&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/connectors/">Connectors</a><button aria-label="Expand sidebar category &#x27;Connectors&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/formats/">Formats</a><button aria-label="Expand sidebar category &#x27;Formats&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pipelines/lifecycle">Lifecycle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pipelines/configuration">Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pipelines/fault-tolerance">Fault tolerance and checkpoint/resume</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pipelines/modifying">Modifying a Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pipelines/checkpoint-sync">Synchronizing checkpoints to object store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pipelines/transactions">Efficient Bulk Data Processing using Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pipelines/latency">Measuring Pipeline Latency</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/operations/guide">Feldera Operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/literature/papers">Literature</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/changelog">Changelog</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/pipelines/"><span>Pipelines</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Modifying a Pipeline</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Modifying a Pipeline While Preserving its State</h1></header>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Enterprise-only feature</div><div class="admonitionContent_BuS1"><p>This feature is only available in Feldera Enterprise Edition.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>This is an experimental feature and may undergo significant
changes, including non-backward-compatible modifications, in future releases of
Feldera.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>Feldera supports <strong>incremental pipeline modification</strong> through a feature called <strong>bootstrapping</strong>.
This allows you to evolve your SQL pipelines by adding, removing, or modifying table and view
definitions without having to discard the pipeline&#x27;s existing state and re-ingest all historical data
from scratch.</p>
<p>When you modify a pipeline:</p>
<ul>
<li><strong>New and modified views</strong> are computed from existing pipeline state</li>
<li><strong>Views not affected by the change</strong> continue using their existing state</li>
<li><strong>Input data</strong> does not need to be re-ingested (unless table schemas change)</li>
<li><strong>New and modified connectors</strong> are added to the pipeline</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Feldera incrementally processes changes to input data. But what happens when the program
itself needs to change, e.g., the user would like to add, remove, or modify a view definition?
Feldera is able to handle such changes incrementally as well by only recomputing
the modified view and any views derived from it. Whenever possible, it uses existing state
in tables and internal indexes maintained by the incremental view maintenance engine
as inputs to evaluate affected views.</p>
<p>This process of building new or modified views from existing state in the pipeline
is called <strong>bootstrapping</strong>. Bootstrapping allows you to evolve your SQL pipeline without
having to re-ingest all historical data from scratch.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-bootstrapping-works">How bootstrapping works<a href="#how-bootstrapping-works" class="hash-link" aria-label="Direct link to How bootstrapping works" title="Direct link to How bootstrapping works">​</a></h2>
<p>In this section we describe steps involved in modifying a pipeline while preserving its state.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-stop-the-pipeline">1. Stop the pipeline<a href="#1-stop-the-pipeline" class="hash-link" aria-label="Direct link to 1. Stop the pipeline" title="Direct link to 1. Stop the pipeline">​</a></h3>
<p>The pipeline must be stopped before it can be modified. During the <code>/stop</code> operation, the state
of the pipeline is checkpointed in storage. Alternatively, if the pipeline crashes or gets force-stopped,
its recent state is preserved in the last <a href="/pipelines/fault-tolerance">periodic checkpoint</a>, as long as checkpointing is
enabled.  This state will later be used to bootstrap the modified pipeline.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-modify-the-pipeline">2. Modify the pipeline<a href="#2-modify-the-pipeline" class="hash-link" aria-label="Direct link to 2. Modify the pipeline" title="Direct link to 2. Modify the pipeline">​</a></h3>
<p>The user modifies the pipeline by making arbitrary changes to its SQL code.
This way many changes across multiple tables and views can be performed at
the same time. This is particularly useful when working with nested views, where
a change to one of the views, such as adding a new column, may require updates to all
downstream views that depend on it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-restart-the-pipeline">3. Restart the pipeline<a href="#3-restart-the-pipeline" class="hash-link" aria-label="Direct link to 3. Restart the pipeline" title="Direct link to 3. Restart the pipeline">​</a></h3>
<p>When a modified pipeline is restarted, it performs the following operations:</p>
<ol>
<li>
<p>Opens its latest checkpoint if one exists.</p>
</li>
<li>
<p>Compares the checkpointed program with the new version being started.
If the program has not been modified since the checkpoint was made, resumes
the pipeline from the checkpoint.</p>
</li>
<li>
<p>If the program has been modified, the behavior depends on the <code>bootstrap_policy</code>
argument passed to the pipeline on startup (see <a href="#api">API section</a> below):</p>
<ul>
<li>
<p><code>bootstrap_policy=await_approval</code> (default) - the pipeline stops in the <code>AwaitingApproval</code>
state. Its <code>deployment_runtime_status_details</code> property (returned by the <a href="https://docs.feldera.com/api/retrieve-a-pipeline" target="_blank" rel="noopener noreferrer">pipeline status endpoint</a>)
lists tables, views, and connectors
affected by the changes.
At this point the pipeline is paused until the user signals their intention.
The user can either approve the changes by calling the
<a href="https://docs.feldera.com/api/approves-the-pipeline-to-proceed-with-bootstrapping" target="_blank" rel="noopener noreferrer"><code>/approve</code></a>
API or terminate the pipeline using <a href="https://docs.feldera.com/api/stop-the-pipeline-asynchronously-by-updating-the-desired-state" target="_blank" rel="noopener noreferrer"><code>/stop?force=true</code></a>.</p>
</li>
<li>
<p><code>bootstrap_policy=allow</code> - the pipeline proceeds to bootstrap modified views
as described in the <a href="#bootstrapping">Bootstrapping</a> section below.</p>
</li>
<li>
<p><code>bootstrap_policy=reject</code> - the pipeline is stopped with an error message
listing pipeline modifications. Its checkpointed state is preserved. The user can
choose to undo modifications or change <code>bootstrap_policy</code> and restart the pipeline
again.</p>
</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bootstrapping">Bootstrapping<a href="#bootstrapping" class="hash-link" aria-label="Direct link to Bootstrapping" title="Direct link to Bootstrapping">​</a></h2>
<p>If pipeline modifications have been approved, the pipeline goes into the <code>Bootstrapping</code> state
and performs the following actions:</p>
<ol>
<li>
<p>Discards any state that has been invalidated, such as state that belongs to deleted or modified
views.</p>
</li>
<li>
<p>The state of any new or modified tables is truncated; all connectors attached to these tables
are reset to their initial state. Once bootstrapping completes, these tables will start empty and
will be populated with data received from input connectors.</p>
<ul>
<li>
<p>A table is considered modified if types, names or the order of its columns have changed in any way,
its primary key constraint has changed, or its <code>materialized</code> or <code>append_only</code> properties were added
or removed.</p>
</li>
<li>
<p>A table is NOT considered modified if only its connector definitions have changed.</p>
</li>
<li>
<p>Any views derived from modified tables are considered modified. During bootstrapping, these
views will be evaluated against the empty table. After bootstrapping completes, the views will be
incrementally updated as the table is populated with data from the input connectors.</p>
</li>
</ul>
</li>
<li>
<p>Evaluates new and modified views based on existing state inside the pipeline and
outputs the complete contents of these views to all attached output connectors.
This is similar to how the pipeline outputs data while ingesting historical data during regular backfill.</p>
<ul>
<li>
<p>A view is considered modified if its query was altered in any way or if its <code>MATERIALIZED</code> attribute
was added or removed.</p>
</li>
<li>
<p>A view is NOT considered modified if only its connector definitions have changed.</p>
</li>
</ul>
</li>
</ol>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Data Sink Cleanup Required</div><div class="admonitionContent_BuS1"><p>The pipeline does not output retractions for the old contents of modified views.
You must clear any connected data sinks before approving the modified pipeline to
avoid duplicate or stale data.</p></div></div>
<p>The pipeline does not ingest any inputs during bootstrapping. Once bootstrapping completes,
the pipeline moves to the <code>Running</code> state, where it resumes ingesting and incrementally processing data
from input connectors. Input connectors that were not modified in the new version of the pipeline and
whose tables have not changed resume ingestion from their checkpointed position in the input stream;
other input connectors will start from the initial state specified in their configuration.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="caveats-and-limitations">Caveats and limitations<a href="#caveats-and-limitations" class="hash-link" aria-label="Direct link to Caveats and limitations" title="Direct link to Caveats and limitations">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="caveat-1-feldera-runtime-upgrade-can-modify-the-pipeline">Caveat 1: Feldera runtime upgrade can modify the pipeline<a href="#caveat-1-feldera-runtime-upgrade-can-modify-the-pipeline" class="hash-link" aria-label="Direct link to Caveat 1: Feldera runtime upgrade can modify the pipeline" title="Direct link to Caveat 1: Feldera runtime upgrade can modify the pipeline">​</a></h3>
<p>Recompiling a pipeline with a new version of Feldera can modify its query plan and trigger
bootstrapping even if its SQL code has not changed.</p>
<p>Feldera pipelines are compiled and executed using the SQL runtime associated with the
installed version of the Feldera platform.
After a Feldera upgrade, existing pipelines continue using the runtime with which they
were originally compiled; however once the pipeline is recompiled, either via the
<a href="https://docs.feldera.com/api/recompile-a-pipeline-with-the-feldera-runtime-version-included-in-the" target="_blank" rel="noopener noreferrer"><code>/update_runtime</code> request</a>
or by editing its SQL code, it will use the SQL runtime
associated with the current version of the Feldera platform. This new runtime may generate
a slightly different query plan for the same SQL tables and views, which will require going through the bootstrapping process.
The affected views will be recomputed from scratch and streamed to the output connectors even
though their contents haven&#x27;t changed.</p>
<p>If this is undesirable, use one of the following methods to avoid updating the SQL runtime of a pipeline:</p>
<ol>
<li>
<p>Avoid updating pipeline&#x27;s runtime. As long as you don&#x27;t invoke <code>/update_runtime</code> or modify
the pipeline&#x27;s code, it will continue running with its original runtime.</p>
</li>
<li>
<p>Pin the pipeline to a specific runtime version using the <a href="/pipelines/lifecycle"><code>runtime_version</code> property</a>.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="caveat-2-starting-from-an-s3-checkpoint">Caveat 2: Starting from an S3 checkpoint<a href="#caveat-2-starting-from-an-s3-checkpoint" class="hash-link" aria-label="Direct link to Caveat 2: Starting from an S3 checkpoint" title="Direct link to Caveat 2: Starting from an S3 checkpoint">​</a></h3>
<p>Normally, when restarting, a pipeline continues from the checkpoint taken at the point when the pipeline was stopped, containing
the pipeline&#x27;s latest state. If the pipeline crashed or was <a href="https://docs.feldera.com/api/stop-the-pipeline-asynchronously-by-updating-the-desired-state" target="_blank" rel="noopener noreferrer">force-stopped</a>, it will pick up the
last <a href="https://docs.feldera.com/pipelines/configuration/#program-configuration" target="_blank" rel="noopener noreferrer">periodic checkpoint</a>, if any.</p>
<p>Alternatively, the user can start the pipeline from a checkpoint in an S3-compatible object
store, created using the <a href="https://docs.feldera.com/pipelines/checkpoint-sync" target="_blank" rel="noopener noreferrer">S3 sync</a> feature. This checkpoint may have been created by an older
version of the same pipeline or even by a different pipeline.  This situation is handled in the
same way: the pipeline computes a diff between the current and the checkpointed query plan, bootstraps
any new and modified views and clears any tables that are not part of the checkpoint.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="caveat-3-views-that-have-not-been-modified-may-require-bootstrapping">Caveat 3: Views that have not been modified may require bootstrapping<a href="#caveat-3-views-that-have-not-been-modified-may-require-bootstrapping" class="hash-link" aria-label="Direct link to Caveat 3: Views that have not been modified may require bootstrapping" title="Direct link to Caveat 3: Views that have not been modified may require bootstrapping">​</a></h3>
<p>The Feldera SQL compiler performs some global optimizations across multiple views. Modifying or
removing one of the views can affect these optimizations, potentially changing the query plan
for other views, not directly affected by the change.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitation-1-tables-must-be-materialized">Limitation 1: Tables must be materialized<a href="#limitation-1-tables-must-be-materialized" class="hash-link" aria-label="Direct link to Limitation 1: Tables must be materialized" title="Direct link to Limitation 1: Tables must be materialized">​</a></h3>
<p>Bootstrapping relies on existing pipeline state to initialize new and modified views.
<a href="/sql/materialized">Materializing</a> all tables in the program by declaring them with <code>&#x27;materialized&#x27; = &#x27;true&#x27;</code>
ensures that the pipeline can be bootstrapped after arbitrary changes from this materialized
state.</p>
<p>A program where not all tables are materialized may fail to start from a checkpoint and require
clearing the pipeline&#x27;s state and restarting the pipeline from scratch instead.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitation-2-bootstrapping-does-not-work-with-lateness">Limitation 2: Bootstrapping does not work with <code>LATENESS</code><a href="#limitation-2-bootstrapping-does-not-work-with-lateness" class="hash-link" aria-label="Direct link to limitation-2-bootstrapping-does-not-work-with-lateness" title="Direct link to limitation-2-bootstrapping-does-not-work-with-lateness">​</a></h3>
<p>Programs with <a href="/tutorials/time-series"><code>LATENESS</code> annotations</a> currently cannot be bootstrapped. These annotations are used
by the query engine to discard state that can no longer affect any future updates to any view.
However, if the modified program contains new views that may depend on the discarded data, they cannot be computed.</p>
<p>We currently do not implement the analysis needed to detect such changes and instead take the more coarse-grained
approach of simply rejecting changes to pipelines with <code>LATENESS</code>. Such pipelines must be
backfilled from scratch after any change by clearing their state before restarting.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitation-3-table-evolution-is-not-yet-supported">Limitation 3: Table evolution is not yet supported<a href="#limitation-3-table-evolution-is-not-yet-supported" class="hash-link" aria-label="Direct link to Limitation 3: Table evolution is not yet supported" title="Direct link to Limitation 3: Table evolution is not yet supported">​</a></h3>
<p>Adding, removing or renaming a table column will clear the table&#x27;s state and require the table
to be ingested from scratch.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitation-4-the-pipeline-does-not-detect-changes-to-udfs">Limitation 4: The pipeline does not detect changes to UDFs<a href="#limitation-4-the-pipeline-does-not-detect-changes-to-udfs" class="hash-link" aria-label="Direct link to Limitation 4: The pipeline does not detect changes to UDFs" title="Direct link to Limitation 4: The pipeline does not detect changes to UDFs">​</a></h3>
<p>Feldera currently assumes that a UDF whose name and signature have not changed does not change its behavior.
If the user modifies the implementation of a UDF without changing its signature, they need to either clear the
state of the pipeline or rename the UDF to trigger the bootstrapping of any views that depend on the modified UDF.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api">API<a href="#api" class="hash-link" aria-label="Direct link to API" title="Direct link to API">​</a></h2>
<p>In this section we describe the REST API elements related to bootstrapping.
All of this functionality is also available via the Python SDK and the <code>fda</code> CLI tool.</p>
<ul>
<li>
<p>The <code>bootstrap_policy</code> argument to the <a href="https://docs.feldera.com/api/stop-the-pipeline-asynchronously-by-updating-the-desired-state" target="_blank" rel="noopener noreferrer"><code>/start</code> endpoint</a>. This argument specifies how the pipeline should
behave when the checkpointed version of the program differs from the current version. The supported values are
<code>await_approval</code>, <code>allow</code>, and <code>reject</code>. The default value is <code>await_approval</code>. See the
<a href="#3-restart-the-pipeline">Restart the pipeline</a> section above for details.</p>
</li>
<li>
<p>Two runtime states reported by the <a href="https://docs.feldera.com/api/retrieve-a-pipeline" target="_blank" rel="noopener noreferrer">pipeline status endpoint</a> in the <code>deployment_runtime_status</code> field:</p>
<ul>
<li><code>AwaitingApproval</code> - When starting the pipeline with <code>bootstrap_policy=await_approval</code>, if the pipeline
requires bootstrapping, it will stop in the <code>AwaitingApproval</code> state waiting for the user to approve the
changes. While in this state, the <code>deployment_runtime_status_details</code> field lists added, modified, and removed
tables, views, and connectors in JSON format.
The pipeline exits this state when the user either approves the pipeline via the <code>/approve</code> API
or force-stops the pipeline with <code>/stop?force=true</code>.</li>
<li><code>Bootstrapping</code> - In this state the pipeline evaluates new and modified views. Once bootstrapping completes,
the pipeline automatically moves into the <code>Running</code> or <code>Paused</code> state.</li>
</ul>
</li>
<li>
<p>The <a href="https://docs.feldera.com/api/approves-the-pipeline-to-proceed-with-bootstrapping" target="_blank" rel="noopener noreferrer"><code>/approve</code> endpoint</a>.
Invoking this endpoint transitions the pipeline from the <code>AwaitingApproval</code> to <code>Bootstrapping</code> state.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="webconsole">WebConsole<a href="#webconsole" class="hash-link" aria-label="Direct link to WebConsole" title="Direct link to WebConsole">​</a></h2>
<p>Bootstrapping is also supported via the WebConsole. The WebConsole always starts pipelines with <code>bootstrap_policy=await_approval</code>.
If the pipeline has changed since the last checkpoint, it shows a dialog with the list of detected pipeline changes where the user can
approve the changes or stop the pipeline.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-different-types-of-changes-are-handled">How different types of changes are handled<a href="#how-different-types-of-changes-are-handled" class="hash-link" aria-label="Direct link to How different types of changes are handled" title="Direct link to How different types of changes are handled">​</a></h2>
<p>This section describes how the bootstrapping process handles different types of changes
to your pipeline.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="views">Views<a href="#views" class="hash-link" aria-label="Direct link to Views" title="Direct link to Views">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-a-view">Adding a view<a href="#adding-a-view" class="hash-link" aria-label="Direct link to Adding a view" title="Direct link to Adding a view">​</a></h4>
<p>New views are evaluated during bootstrapping; their full contents are sent to all attached output connectors.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-a-view">Modifying a view<a href="#modifying-a-view" class="hash-link" aria-label="Direct link to Modifying a view" title="Direct link to Modifying a view">​</a></h4>
<p>A view is modified when the user changes its SQL definition or as a side effect of a change to an upstream
view or a runtime upgrade. The old state of modified views is discarded; the view is evaluated from
scratch, and its full contents are sent to all attached output connectors.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removing-a-view">Removing a view<a href="#removing-a-view" class="hash-link" aria-label="Direct link to Removing a view" title="Direct link to Removing a view">​</a></h4>
<p>The view, all of its connectors, and all internal indexes used to maintain the view incrementally
are discarded.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tables">Tables<a href="#tables" class="hash-link" aria-label="Direct link to Tables" title="Direct link to Tables">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-a-table">Adding a table<a href="#adding-a-table" class="hash-link" aria-label="Direct link to Adding a table" title="Direct link to Adding a table">​</a></h4>
<p>New tables are created empty.
Note that renaming an existing table is treated as deleting the old table and creating a new one.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-a-table">Modifying a table<a href="#modifying-a-table" class="hash-link" aria-label="Direct link to Modifying a table" title="Direct link to Modifying a table">​</a></h4>
<p>Modifying a table clears the state of the table and all views that depend on it during bootstrapping.
All table connectors are reset to their initial states.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removing-a-table">Removing a table<a href="#removing-a-table" class="hash-link" aria-label="Direct link to Removing a table" title="Direct link to Removing a table">​</a></h4>
<p>All state of the deleted table is discarded.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="connectors">Connectors<a href="#connectors" class="hash-link" aria-label="Direct link to Connectors" title="Direct link to Connectors">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-a-connector">Adding a connector<a href="#adding-a-connector" class="hash-link" aria-label="Direct link to Adding a connector" title="Direct link to Adding a connector">​</a></h4>
<ul>
<li>
<p>New <em>input</em> connectors are initialized according to their configuration.
They are activated after bootstrapping completes and the pipeline moves to
the <code>Running</code> state.</p>
</li>
<li>
<p>New <em>output</em> connectors attached to <em>new or modified</em> views are activated during
bootstrapping. They receive the complete contents of the view computed during
bootstrapping.</p>
</li>
<li>
<p>New <em>output</em> connectors attached to <em>existing</em> views are activated after the
pipeline moves to the <code>Running</code> state. These connectors only receive new changes
to the views.</p>
</li>
</ul>
<p>Feldera uses connector names to uniquely identify connectors within the scope of
a table or view. Renaming a connector is treated as deleting the old connector
and adding a new connector with an identical configuration.</p>
<p>We recommend explicitly naming all connectors. Anonymous connectors
are automatically assigned names based on the order of their declaration. Such
automatic names are less stable than explicitly assigned names and can cause
spurious changes to be detected in modified pipelines.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-a-connector">Modifying a connector<a href="#modifying-a-connector" class="hash-link" aria-label="Direct link to Modifying a connector" title="Direct link to Modifying a connector">​</a></h4>
<ul>
<li>
<p>Modified input connectors are initialized according to the new configuration.
Any checkpointed state (e.g., the latest offset ingested by the connector)
is discarded and the connector is reset to its initial state.
Any data previously ingested by the connector is not affected.</p>
</li>
<li>
<p>Modified output connectors are initialized according to the new configuration.</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removing-a-connector">Removing a connector<a href="#removing-a-connector" class="hash-link" aria-label="Direct link to Removing a connector" title="Direct link to Removing a connector">​</a></h4>
<p>When an input connector is removed, any records previously ingested by the connector
remain in the table.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h2>
<p>In this example, we use the Python SDK to demonstrate how to modify a running pipeline and bootstrap the changes.
We start with a pipeline that tracks student grades and computes average grades per class
within a specific date range. Then we transform the pipeline by:</p>
<ol>
<li>
<p>Extending the date range in the <code>avg_grade</code> view, which causes the <code>avg_grade_enriched</code>
view to change as well.</p>
</li>
<li>
<p>Adding a new <code>avg_grade_all_courses</code> view that computes the overall average across all courses.</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Example: modifying and bootstrapping a pipeline" src="/assets/images/modified_pipeline-eed3c062cbef4112c444d8816f178525.png" width="1404" height="697" class="img_ev3q"></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> decimal </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> feldera</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enums </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BootstrapPolicy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PipelineStatus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> feldera</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline_builder </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PipelineBuilder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> feldera</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">runtime_config </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> RuntimeConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tests </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> TEST_CLIENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> enterprise_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">helper </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gen_pipeline_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># SQL program parameterized by start and end dates.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">gen_sql</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">start_date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end_date</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;create table students (</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  id bigint,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  name varchar</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">) with (</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  &#x27;materialized&#x27; = &#x27;true&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">create table grades (</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  student_id bigint,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  class string,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  grade decimal(5,2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  class_date date</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">) with (</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  &#x27;materialized&#x27; = &#x27;true&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">-- Average grade per student per class over a fixed date range.</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">create view avg_grade as</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">select</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  student_id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  class,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  AVG(grade) as class_avg</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">from grades</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">where</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  class_date &gt;= date &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">start_date</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27; and class_date &lt;= date &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">end_date</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">group by student_id, class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">-- Similar to avg_grade, but contains student name instead of Id.</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">create materialized view avg_grade_enriched as</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">select</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  name as student_name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  class,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  class_avg</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">from</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">  avg_grade join students on avg_grade.student_id = students.id;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create and start the pipeline.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PipelineBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TEST_CLIENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pipeline_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sql</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gen_sql</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;2025-09-01&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-12-15&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime_config</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">RuntimeConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dev_tweaks</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;backfill_avoidance&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># This should not be necessary once it is enabled by default.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_or_replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> PipelineStatus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RUNNING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Feed some input data.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;insert into students values (1, &#x27;Alice&#x27;), (2, &#x27;Bob&#x27;)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;insert into grades values</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(1, &#x27;algebra&#x27;, 97, &#x27;2025-09-15&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(1, &#x27;physics&#x27;, 89, &#x27;2025-11-15&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(2, &#x27;algebra&#x27;, 85, &#x27;2025-10-22&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(2, &#x27;physics&#x27;, 93, &#x27;2025-12-05&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(1, &#x27;algebra&#x27;, 95, &#x27;2026-01-15&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(1, &#x27;physics&#x27;, 87, &#x27;2026-03-15&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(2, &#x27;algebra&#x27;, 98, &#x27;2026-04-22&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">(2, &#x27;physics&#x27;, 91, &#x27;2026-05-05&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Validate outputs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT * FROM avg_grade_enriched order by student_name, class&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Alice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;algebra&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;97.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Alice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;physics&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;89.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;algebra&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;85.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;physics&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;93.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">force</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">additional_view </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">create materialized view avg_grade_all_courses as</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">select</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">  student_id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">  avg(class_avg) as avg</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">from avg_grade</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">group by student_id;&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Make two changes to the pipeline:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Add a new view.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Modify the avg_grade view, extending its date range.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sql</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">gen_sql</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;2025-09-01&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2026-06-10&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> additional_view</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start the pipeline with await_approval bootstrap policy.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bootstrap_policy</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">BootstrapPolicy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AWAIT_APPROVAL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> PipelineStatus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AWAITINGAPPROVAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># When in the AwaitingApproval state, deployment_runtime_status_details shows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># changes between the current and the checkpointed version of the pipeline.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Note: the avg_grade_enriched view is modified, as it depends on the modified avg_grade view.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diff </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deployment_runtime_status_details</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> diff </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;added_input_connectors&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;added_output_connectors&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;modified_input_connectors&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;modified_output_connectors&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;program_diff&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;added_tables&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;added_views&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;avg_grade_all_courses&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;modified_tables&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;modified_views&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;avg_grade&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;avg_grade_enriched&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;removed_tables&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;removed_views&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;program_diff_error&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;removed_input_connectors&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;removed_output_connectors&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Approve the changes and wait for the pipeline to complete bootstrapping new</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># and modified views and reach the RUNNING state.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">approve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">wait_for_status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PipelineStatus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RUNNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">300</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># The new outputs should reflect input data within the modified date range.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT * FROM avg_grade_enriched order by student_name, class&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Alice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;algebra&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;96.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Alice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;physics&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;88.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;algebra&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;91.50&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;physics&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;class_avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;92.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT * FROM avg_grade_all_courses order by student_id&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;92.00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;student_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;avg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Decimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;91.75&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>Pipeline modification with bootstrapping enables you to evolve your Feldera pipelines incrementally:</p>
<p><strong>Key Benefits:</strong></p>
<ul>
<li>Modify SQL definitions without re-ingesting historical data</li>
<li>Add new views computed from existing state</li>
<li>Change multiple tables and views atomically</li>
<li>Review and approve changes before they take effect</li>
</ul>
<p><strong>Workflow:</strong></p>
<ol>
<li>Stop the pipeline (state is automatically checkpointed)</li>
<li>Modify the SQL code</li>
<li>Restart with desired <code>bootstrap_policy</code> (default: <code>await_approval</code>)</li>
<li>Review changes in <code>deployment_runtime_status_details</code></li>
<li>Approve changes via <code>/approve</code> endpoint (if using <code>await_approval</code>)</li>
<li>Wait for bootstrapping to complete and pipeline to reach <code>Running</code> state</li>
</ol></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/pipelines/fault-tolerance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Fault tolerance and checkpoint/resume</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pipelines/checkpoint-sync"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Synchronizing checkpoints to object store</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#how-bootstrapping-works" class="table-of-contents__link toc-highlight">How bootstrapping works</a><ul><li><a href="#1-stop-the-pipeline" class="table-of-contents__link toc-highlight">1. Stop the pipeline</a></li><li><a href="#2-modify-the-pipeline" class="table-of-contents__link toc-highlight">2. Modify the pipeline</a></li><li><a href="#3-restart-the-pipeline" class="table-of-contents__link toc-highlight">3. Restart the pipeline</a></li></ul></li><li><a href="#bootstrapping" class="table-of-contents__link toc-highlight">Bootstrapping</a></li><li><a href="#caveats-and-limitations" class="table-of-contents__link toc-highlight">Caveats and limitations</a><ul><li><a href="#caveat-1-feldera-runtime-upgrade-can-modify-the-pipeline" class="table-of-contents__link toc-highlight">Caveat 1: Feldera runtime upgrade can modify the pipeline</a></li><li><a href="#caveat-2-starting-from-an-s3-checkpoint" class="table-of-contents__link toc-highlight">Caveat 2: Starting from an S3 checkpoint</a></li><li><a href="#caveat-3-views-that-have-not-been-modified-may-require-bootstrapping" class="table-of-contents__link toc-highlight">Caveat 3: Views that have not been modified may require bootstrapping</a></li><li><a href="#limitation-1-tables-must-be-materialized" class="table-of-contents__link toc-highlight">Limitation 1: Tables must be materialized</a></li><li><a href="#limitation-2-bootstrapping-does-not-work-with-lateness" class="table-of-contents__link toc-highlight">Limitation 2: Bootstrapping does not work with <code>LATENESS</code></a></li><li><a href="#limitation-3-table-evolution-is-not-yet-supported" class="table-of-contents__link toc-highlight">Limitation 3: Table evolution is not yet supported</a></li><li><a href="#limitation-4-the-pipeline-does-not-detect-changes-to-udfs" class="table-of-contents__link toc-highlight">Limitation 4: The pipeline does not detect changes to UDFs</a></li></ul></li><li><a href="#api" class="table-of-contents__link toc-highlight">API</a></li><li><a href="#webconsole" class="table-of-contents__link toc-highlight">WebConsole</a></li><li><a href="#how-different-types-of-changes-are-handled" class="table-of-contents__link toc-highlight">How different types of changes are handled</a><ul><li><a href="#views" class="table-of-contents__link toc-highlight">Views</a></li><li><a href="#tables" class="table-of-contents__link toc-highlight">Tables</a></li><li><a href="#connectors" class="table-of-contents__link toc-highlight">Connectors</a></li></ul></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/get-started">Get Started</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials/basics/part1">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/sql/intro">SQL Reference</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/felderacommunity/shared_invite/zt-222bq930h-dgsu5IEzAihHg8nQt~dHzA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.com/invite/s6t5n9UzHE" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://bsky.app/profile/feldera.bsky.social" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bluesky<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/feldera/feldera" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Feldera Inc.</div></div></div></footer></div>
</body>
</html>