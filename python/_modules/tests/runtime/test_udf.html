<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tests.runtime.test_udf &mdash; Feldera Python SDK 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Feldera Python SDK
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pandas.html">Pandas Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">python</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Feldera Python SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">tests.runtime.test_udf</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for tests.runtime.test_udf</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">decimal</span><span class="w"> </span><span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">Timedelta</span><span class="p">,</span> <span class="n">Timestamp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feldera</span><span class="w"> </span><span class="kn">import</span> <span class="n">PipelineBuilder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tests</span><span class="w"> </span><span class="kn">import</span> <span class="n">TEST_CLIENT</span><span class="p">,</span> <span class="n">unique_pipeline_name</span>


<div class="viewcode-block" id="TestUDF">
<a class="viewcode-back" href="../../../tests.runtime.html#tests.runtime.test_udf.TestUDF">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestUDF</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestUDF.test_local">
<a class="viewcode-back" href="../../../tests.runtime.html#tests.runtime.test_udf.TestUDF.test_local">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">CREATE TYPE my_struct AS (</span>
<span class="s2">   i INT,</span>
<span class="s2">   s VARCHAR</span>
<span class="s2">);</span>

<span class="s2">CREATE TABLE t (</span>
<span class="s2">    i INT,</span>
<span class="s2">    ti TINYINT,</span>
<span class="s2">    si SMALLINT,</span>
<span class="s2">    bi BIGINT,</span>
<span class="s2">    r REAL,</span>
<span class="s2">    d DOUBLE,</span>
<span class="s2">    bin VARBINARY,</span>
<span class="s2">    dt DATE,</span>
<span class="s2">    t TIME,</span>
<span class="s2">    ts TIMESTAMP,</span>
<span class="s2">    a INT ARRAY,</span>
<span class="s2">    m MAP&lt;VARCHAR, VARCHAR&gt;,</span>
<span class="s2">    v VARIANT,</span>
<span class="s2">    b BOOLEAN,</span>
<span class="s2">    dc DECIMAL(7,2),</span>
<span class="s2">    s VARCHAR,</span>
<span class="s2">    ms MY_STRUCT</span>
<span class="s2">) with (&#39;materialized&#39; = &#39;true&#39;);</span>

<span class="s2">CREATE FUNCTION bool2bool(i BOOLEAN) RETURNS BOOLEAN;</span>
<span class="s2">CREATE FUNCTION nbool2nbool(i BOOLEAN NOT NULL) RETURNS BOOLEAN NOT NULL;</span>

<span class="s2">CREATE FUNCTION i2i(i INT) RETURNS INT;</span>
<span class="s2">CREATE FUNCTION ni2ni(i INT NOT NULL) RETURNS INT NOT NULL;</span>

<span class="s2">CREATE FUNCTION ti2ti(i TINYINT) RETURNS TINYINT;</span>
<span class="s2">CREATE FUNCTION nti2nti(i TINYINT NOT NULL) RETURNS TINYINT NOT NULL;</span>

<span class="s2">CREATE FUNCTION si2si(i SMALLINT) RETURNS SMALLINT;</span>
<span class="s2">CREATE FUNCTION nsi2nsi(i SMALLINT NOT NULL) RETURNS SMALLINT NOT NULL;</span>

<span class="s2">CREATE FUNCTION bi2bi(i BIGINT) RETURNS BIGINT;</span>
<span class="s2">CREATE FUNCTION nbi2nbi(i BIGINT NOT NULL) RETURNS BIGINT NOT NULL;</span>

<span class="s2">CREATE FUNCTION r2r(i REAL) RETURNS REAL;</span>
<span class="s2">CREATE FUNCTION nr2nr(i REAL NOT NULL) RETURNS REAL NOT NULL;</span>

<span class="s2">CREATE FUNCTION d2d(i DOUBLE) RETURNS DOUBLE;</span>
<span class="s2">CREATE FUNCTION nd2nd(i DOUBLE NOT NULL) RETURNS DOUBLE NOT NULL;</span>

<span class="s2">CREATE FUNCTION bin2bin(i VARBINARY) RETURNS VARBINARY;</span>
<span class="s2">CREATE FUNCTION nbin2nbin(i VARBINARY NOT NULL) RETURNS VARBINARY NOT NULL;</span>

<span class="s2">CREATE FUNCTION date2date(i DATE) RETURNS DATE;</span>
<span class="s2">CREATE FUNCTION ndate2ndate(i DATE NOT NULL) RETURNS DATE NOT NULL;</span>

<span class="s2">CREATE FUNCTION ts2ts(i TIMESTAMP) RETURNS TIMESTAMP;</span>
<span class="s2">CREATE FUNCTION nts2nts(i TIMESTAMP NOT NULL) RETURNS TIMESTAMP NOT NULL;</span>

<span class="s2">CREATE FUNCTION t2t(i TIME) RETURNS TIME;</span>
<span class="s2">CREATE FUNCTION nt2nt(i TIME NOT NULL) RETURNS TIME NOT NULL;</span>

<span class="s2">CREATE FUNCTION arr2arr(i INT ARRAY) RETURNS INT ARRAY;</span>
<span class="s2">CREATE FUNCTION narr2narr(i INT ARRAY NOT NULL) RETURNS INT ARRAY NOT NULL;</span>

<span class="s2">CREATE FUNCTION map2map(i MAP&lt;VARCHAR, VARCHAR&gt;) RETURNS MAP&lt;VARCHAR, VARCHAR&gt;;</span>
<span class="s2">CREATE FUNCTION nmap2nmap(i MAP&lt;VARCHAR, VARCHAR&gt; NOT NULL) RETURNS MAP&lt;VARCHAR, VARCHAR&gt; NOT NULL;</span>

<span class="s2">CREATE FUNCTION var2var(i VARIANT) RETURNS VARIANT;</span>
<span class="s2">CREATE FUNCTION nvar2nvar(i VARIANT NOT NULL) RETURNS VARIANT NOT NULL;</span>

<span class="s2">CREATE FUNCTION dec2dec(i DECIMAL(7, 2)) RETURNS DECIMAL(7, 2);</span>
<span class="s2">CREATE FUNCTION ndec2ndec(i DECIMAL(7, 2) NOT NULL) RETURNS DECIMAL(7, 2) NOT NULL;</span>

<span class="s2">CREATE FUNCTION str2str(i VARCHAR) RETURNS VARCHAR;</span>
<span class="s2">CREATE FUNCTION nstr2nstr(i VARCHAR NOT NULL) RETURNS VARCHAR NOT NULL;</span>

<span class="s2">CREATE FUNCTION struct2struct(i my_struct) RETURNS my_struct;</span>
<span class="s2">CREATE FUNCTION nstruct2nstruct(i my_struct NOT NULL) RETURNS my_struct NOT NULL;</span>

<span class="s2">CREATE MATERIALIZED VIEW v AS</span>
<span class="s2">SELECT</span>
<span class="s2">    bool2bool(b),</span>
<span class="s2">    nbool2nbool(COALESCE(b, FALSE)),</span>
<span class="s2">    i2i(i),</span>
<span class="s2">    ni2ni(COALESCE(i, 0)),</span>
<span class="s2">    ti2ti(ti),</span>
<span class="s2">    nti2nti(COALESCE(ti, 0)),</span>
<span class="s2">    si2si(si),</span>
<span class="s2">    nsi2nsi(COALESCE(si, 0)),</span>
<span class="s2">    bi2bi(bi),</span>
<span class="s2">    nbi2nbi(COALESCE(bi, 0)),</span>
<span class="s2">    r2r(r),</span>
<span class="s2">    nr2nr(COALESCE(r, 0.0)),</span>
<span class="s2">    d2d(d),</span>
<span class="s2">    nd2nd(COALESCE(d, 0.0)),</span>
<span class="s2">    bin2bin(bin),</span>
<span class="s2">    nbin2nbin(COALESCE(bin, x&#39;&#39;)),</span>
<span class="s2">    date2date(dt),</span>
<span class="s2">    ndate2ndate(COALESCE(dt, DATE &#39;2023-01-01&#39;)),</span>
<span class="s2">    ts2ts(ts),</span>
<span class="s2">    nts2nts(COALESCE(ts, TIMESTAMP &#39;2023-01-01 00:00:00&#39;)),</span>
<span class="s2">    t2t(t),</span>
<span class="s2">    nt2nt(COALESCE(t, TIME &#39;00:00:00&#39;)),</span>
<span class="s2">    arr2arr(a),</span>
<span class="s2">    narr2narr(a),</span>
<span class="s2">    map2map(m),</span>
<span class="s2">    nmap2nmap(m),</span>
<span class="s2">    var2var(v),</span>
<span class="s2">    nvar2nvar(COALESCE(v, VARIANTNULL())),</span>
<span class="s2">    dec2dec(dc),</span>
<span class="s2">    ndec2ndec(COALESCE(dc, 0)),</span>
<span class="s2">    str2str(s),</span>
<span class="s2">    nstr2nstr(COALESCE(s, &#39;&#39;))</span>
<span class="s2">FROM</span>
<span class="s2">    t;</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">udfs</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">use feldera_sqllib::F32;</span>
<span class="s2">use crate::*;</span>

<span class="s2">pub fn bool2bool(i: Option&lt;bool&gt;) -&gt; Result&lt;Option&lt;bool&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nbool2nbool(i: bool) -&gt; Result&lt;bool, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn i2i(i: Option&lt;i32&gt;) -&gt; Result&lt;Option&lt;i32&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn ni2ni(i: i32) -&gt; Result&lt;i32, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn ti2ti(i: Option&lt;i8&gt;) -&gt; Result&lt;Option&lt;i8&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nti2nti(i: i8) -&gt; Result&lt;i8, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn si2si(i: Option&lt;i16&gt;) -&gt; Result&lt;Option&lt;i16&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nsi2nsi(i: i16) -&gt; Result&lt;i16, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn bi2bi(i: Option&lt;i64&gt;) -&gt; Result&lt;Option&lt;i64&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nbi2nbi(i: i64) -&gt; Result&lt;i64, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn r2r(i: Option&lt;F32&gt;) -&gt; Result&lt;Option&lt;F32&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nr2nr(i: F32) -&gt; Result&lt;F32, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn d2d(i: Option&lt;F64&gt;) -&gt; Result&lt;Option&lt;F64&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nd2nd(i: F64) -&gt; Result&lt;F64, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn bin2bin(i: Option&lt;ByteArray&gt;) -&gt; Result&lt;Option&lt;ByteArray&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nbin2nbin(i: ByteArray) -&gt; Result&lt;ByteArray, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn date2date(i: Option&lt;Date&gt;) -&gt; Result&lt;Option&lt;Date&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn ndate2ndate(i: Date) -&gt; Result&lt;Date, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn ts2ts(i: Option&lt;Timestamp&gt;) -&gt; Result&lt;Option&lt;Timestamp&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nts2nts(i: Timestamp) -&gt; Result&lt;Timestamp, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn t2t(i: Option&lt;Time&gt;) -&gt; Result&lt;Option&lt;Time&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nt2nt(i: Time) -&gt; Result&lt;Time, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn arr2arr(i: Option&lt;Array&lt;Option&lt;i32&gt;&gt;&gt;) -&gt; Result&lt;Option&lt;Array&lt;Option&lt;i32&gt;&gt;&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn narr2narr(i: Array&lt;Option&lt;i32&gt;&gt;) -&gt; Result&lt;Array&lt;Option&lt;i32&gt;&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn map2map(i: Option&lt;Map&lt;SqlString, Option&lt;SqlString&gt;&gt;&gt;) -&gt; Result&lt;Option&lt;Map&lt;SqlString, Option&lt;SqlString&gt;&gt;&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nmap2nmap(i: Map&lt;SqlString, Option&lt;SqlString&gt;&gt;) -&gt; Result&lt;Map&lt;SqlString, Option&lt;SqlString&gt;&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn var2var(i: Option&lt;Variant&gt;) -&gt; Result&lt;Option&lt;Variant&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nvar2nvar(i: Variant) -&gt; Result&lt;Variant, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn dec2dec(i: Option&lt;SqlDecimal&lt;7, 2&gt;&gt;) -&gt; Result&lt;Option&lt;SqlDecimal&lt;7, 2&gt;&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn ndec2ndec(i: SqlDecimal&lt;7, 2&gt;) -&gt; Result&lt;SqlDecimal&lt;7, 2&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn str2str(i: Option&lt;SqlString&gt;) -&gt; Result&lt;Option&lt;SqlString&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nstr2nstr(i: SqlString) -&gt; Result&lt;SqlString, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn struct2struct(i: Option&lt;Tup2&lt;Option&lt;i32&gt;, Option&lt;SqlString&gt;&gt;&gt;) -&gt; Result&lt;Option&lt;Tup2&lt;Option&lt;i32&gt;, Option&lt;SqlString&gt;&gt;&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">pub fn nstruct2nstruct(i: Tup2&lt;Option&lt;i32&gt;, Option&lt;SqlString&gt;&gt;) -&gt; Result&lt;Tup2&lt;Option&lt;i32&gt;, Option&lt;SqlString&gt;&gt;, Box&lt;dyn std::error::Error&gt;&gt; {</span>
<span class="s2">    Ok(i)</span>
<span class="s2">}</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">pipeline</span> <span class="o">=</span> <span class="n">PipelineBuilder</span><span class="p">(</span>
            <span class="n">TEST_CLIENT</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">unique_pipeline_name</span><span class="p">(</span><span class="s2">&quot;test_udfs&quot;</span><span class="p">),</span> <span class="n">sql</span><span class="o">=</span><span class="n">sql</span><span class="p">,</span> <span class="n">udf_rust</span><span class="o">=</span><span class="n">udfs</span>
        <span class="p">)</span><span class="o">.</span><span class="n">create_or_replace</span><span class="p">()</span>

        <span class="c1"># TODO: use .query() instead</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>

        <span class="n">pipeline</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="n">pipeline</span><span class="o">.</span><span class="n">input_json</span><span class="p">(</span>
            <span class="s2">&quot;t&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;ti&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;si&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="s2">&quot;bi&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>
                    <span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                    <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>
                    <span class="s2">&quot;bin&quot;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-09-25&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="s2">&quot;13:05:00&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-09-25 13:05:00&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                    <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">},</span>
                    <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s1">&#39;{&quot;foo&quot;: &quot;bar&quot;}&#39;</span><span class="p">,</span>
                    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;dc&quot;</span><span class="p">:</span> <span class="s2">&quot;123.45&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;foobar&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="n">pipeline</span><span class="o">.</span><span class="n">wait_for_idle</span><span class="p">()</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;EXPR$0&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$1&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$10&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$11&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$12&quot;</span><span class="p">:</span> <span class="mf">1e-05</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$13&quot;</span><span class="p">:</span> <span class="mf">1e-05</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$14&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;EXPR$15&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;EXPR$16&quot;</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2024-09-25 00:00:00&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$17&quot;</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2024-09-25 00:00:00&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$18&quot;</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2024-09-25 13:05:00&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$19&quot;</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2024-09-25 13:05:00&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$2&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$20&quot;</span><span class="p">:</span> <span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;0 days 13:05:00&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$21&quot;</span><span class="p">:</span> <span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;0 days 13:05:00&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$22&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                <span class="s2">&quot;EXPR$23&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                <span class="s2">&quot;EXPR$24&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">},</span>
                <span class="s2">&quot;EXPR$25&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">},</span>
                <span class="s2">&quot;EXPR$26&quot;</span><span class="p">:</span> <span class="s1">&#39;{&quot;foo&quot;: &quot;bar&quot;}&#39;</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$27&quot;</span><span class="p">:</span> <span class="s1">&#39;{&quot;foo&quot;: &quot;bar&quot;}&#39;</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$28&quot;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;123.45&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$29&quot;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;123.45&quot;</span><span class="p">),</span>
                <span class="s2">&quot;EXPR$3&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$30&quot;</span><span class="p">:</span> <span class="s2">&quot;foobar&quot;</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$31&quot;</span><span class="p">:</span> <span class="s2">&quot;foobar&quot;</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$4&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$5&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$6&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$7&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$8&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;EXPR$9&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;insert_delete&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">]</span>

        <span class="n">pipeline</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
</div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Feldera.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>