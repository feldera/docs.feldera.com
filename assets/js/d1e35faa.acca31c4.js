"use strict";(self.webpackChunkfeldera_docs=self.webpackChunkfeldera_docs||[]).push([[2757],{28453:(e,n,o)=>{o.d(n,{R:()=>c,x:()=>r});var i=o(96540);const t={},s=i.createContext(t);function c(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(s.Provider,{value:n},e.children)}},61084:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"connectors/sources/pubsub","title":"Google Pub/Sub input connector","description":"This page describes configuration options specific to the Google Pub/Sub connector.","source":"@site/docs/connectors/sources/pubsub.md","sourceDirName":"connectors/sources","slug":"/connectors/sources/pubsub","permalink":"/connectors/sources/pubsub","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Kafka","permalink":"/connectors/sources/kafka"},"next":{"title":"NATS","permalink":"/connectors/sources/nats"}}');var t=o(74848),s=o(28453);const c={},r="Google Pub/Sub input connector",l={},a=[{value:"Configuration options",id:"configuration-options",level:2},{value:"Authentication",id:"authentication",level:3},{value:"Subscription",id:"subscription",level:3},{value:"Connectivity",id:"connectivity",level:3},{value:"Emulator",id:"emulator",level:3},{value:"Example",id:"example",level:2},{value:"Additional resources",id:"additional-resources",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"google-pubsub-input-connector",children:"Google Pub/Sub input connector"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["This page describes configuration options specific to the Google Pub/Sub connector.\nSee ",(0,t.jsx)(n.a,{href:"/connectors/",children:"top-level connector documentation"})," for general information\nabout configuring input and output connectors."]})}),"\n",(0,t.jsx)(n.p,{children:"The Google Pub/Sub connector is used to consume a stream of changes to a SQL table from a Pub/Sub subscription."}),"\n",(0,t.jsxs)(n.p,{children:["The Google Pub/Sub input connector does not yet support ",(0,t.jsx)(n.a,{href:"/pipelines/fault-tolerance",children:"fault\ntolerance"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"configuration-options",children:"Configuration options"}),"\n",(0,t.jsx)(n.p,{children:"This connector supports four groups of configuration options:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#authentication",children:"Authentication options"})," control Google Cloud authentication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#subscription",children:"Subscription options"})," specify an existing Pub/Sub subscription from which\nthe connector will pull messages"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#connectivity",children:"Connectivity options"})," configure gRPC connection to the Pub/Sub service"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#emulator",children:"Emulator options"})," are used to connect to a Pub/Sub emulator instead of the\nreal Google Pub/Sub service"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The only required option that must be present in any valid Pub/Sub connector configuration is\n",(0,t.jsx)(n.code,{children:"subscription"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"authentication",children:"Authentication"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"credentials"})," - The content of a Google Cloud credentials JSON file."]}),"\n",(0,t.jsxs)(n.p,{children:["In order to access a Pub/Sub topic, the connector must authenticate with Google Cloud.\nWhen Feldera runs in an environment with\n",(0,t.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/application-default-credentials",children:"Application Default Credentials (ADC)"}),"\nconfigured, the connector will pickup the credentials automatically from the\n",(0,t.jsx)(n.code,{children:"GOOGLE_APPLICATION_CREDENTIALS"})," environment variable or from the\n",(0,t.jsx)(n.code,{children:"$HOME/.config/gcloud/application_default_credentials.json"})," file."]}),"\n",(0,t.jsxs)(n.p,{children:["When running Feldera in an environment where ADC are not configured,\n\xa0 e.g., a Docker container, use the ",(0,t.jsx)(n.code,{children:"credentials"})," option to ship Google Cloud\ncredentials from another environment.  For example, if you use the\n",(0,t.jsx)(n.a,{href:"https://cloud.google.com/pubsub/docs/authentication#client-libs",children:(0,t.jsx)(n.code,{children:"gcloud auth application-default login"})}),"\ncommand for authentication in your local development environment, ADC are stored in the\n",(0,t.jsx)(n.code,{children:"$HOME/.config/gcloud/application_default_credentials.json"})," file."]}),"\n",(0,t.jsxs)(n.p,{children:["Note that authentication is not required when running against a Pub/Sub ",(0,t.jsx)(n.a,{href:"#emulator",children:"emulator"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"#example",children:"example"})," below for more details on configuring ",(0,t.jsx)(n.code,{children:"credentials"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"project_id"})," - Google Cloud project_id.\nWhen not specified, the connector will use the project id associated\nwith the authenticated account."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"subscription",children:"Subscription"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"subscription"})," - Pub/Sub subscription name.  The subscription must exist."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"snapshot"})," -  Reset subscription's backlog to a given snapshot on startup,\nusing the Pub/Sub ",(0,t.jsx)(n.code,{children:"Seek"})," API.\nThis option is mutually exclusive with the ",(0,t.jsx)(n.code,{children:"timestamp"})," option."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"timestamp"})," - Reset subscription's backlog to a given timestamp on startup,\nusing the Pub/Sub ",(0,t.jsx)(n.code,{children:"Seek"}),' API. The value of this field is an\nISO 8601-encoded UTC time, e.g., "2024-08-17T16:39:57-08:00".\nThis option is mutually exclusive with the ',(0,t.jsx)(n.code,{children:"snapshot"})," option."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"connectivity",children:"Connectivity"}),"\n",(0,t.jsx)(n.p,{children:"These options configure gRPC connection to the Pub/Sub service."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"endpoint"})," - Overrides the default service endpoint 'pubsub.googleapis.com'."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"pool_size"})," - gRPC channel pool size."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"timeout_seconds"})," - gRPC request timeout."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"connect_timeout_seconds"})," - gRPC connection timeout."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"emulator",children:"Emulator"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"emulator"})," - Pub/Sub emulator URL in the 'host",":port","' format. Use this option\nto connect to a Pub/Sub ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/pubsub/docs/emulator",children:"emulator"}),"\ninstead of the production service."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.p,{children:"In this section, we provide a step-by-step guide to configuring and using a Feldera Pub/Sub connector.\nPlease ensure you have a Google Cloud account before proceeding."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create Application Default Credentials in your local development environment."}),"\n",(0,t.jsxs)(n.p,{children:["Install ",(0,t.jsx)(n.code,{children:"gcloud"}),", the ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/cli?hl=en",children:"Google Cloud CLI"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Opens a Web browser for authentication.\ngcloud init\ngcloud auth application-default login\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The second command will store ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/application-default-credentials",children:"Application Default Credentials (ADC)"}),"\nin the ",(0,t.jsx)(n.code,{children:"$HOME/.config/gcloud/application_default_credentials.json"})," file."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"gcloud"})," CLI to create a test topic and a subscription."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gcloud pubsub topics create test-topic\ngcloud pubsub subscriptions create test-subscription --retain-acked-messages --topic test-topic\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Publish some messages to the topic"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'for i in {1..10}; do gcloud pubsub topics publish test-topic --message "{\\"id\\": $i}"; done\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ingest messages in Feldera."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Copy the following code to the Feldera WebConsole, replacing the ",(0,t.jsx)(n.code,{children:"credentials"})," field with\n",(0,t.jsxs)(n.strong,{children:["escaped content of ",(0,t.jsx)(n.code,{children:"$HOME/.config/gcloud/application_default_credentials.json"})]}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE pub_sub_input (\n  id int\n) WITH (\n    \'connectors\' = \'[\n    {\n      "transport": {\n          "name": "pub_sub_input",\n          "config": {\n              "subscription": "test-subscription",\n              "timestamp": "2024-08-17T00:00:00-00:00",\n              "credentials": "{\\"account\\": \\"\\",\\"client_id\\": \\"<CLIENT_ID>\\",\\"client_secret\\": \\"<CLIENT_SECRET>\\", \\"quota_project_id\\": \\"feldera-test\\", \\"refresh_token\\": \\"<REFRESH_TOKEN>\\",  \\"type\\": \\"authorized_user\\",  \\"universe_domain\\": \\"googleapis.com\\"}",\n          }\n      },\n      "format": {\n          "name": "json",\n          "config": {\n              "update_format": "raw"\n          }\n      }\n  }]\'\n);\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Select the ",(0,t.jsx)(n.code,{children:"pub_sub_input"}),' table in the "Changes stream" tab and run the pipeline.  You should see the ten messages\nyou published in Step 3 in the change stream of the pipeline.']}),"\n",(0,t.jsx)(n.h2,{id:"additional-resources",children:"Additional resources"}),"\n",(0,t.jsx)(n.p,{children:"For more information, see:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/connectors/",children:"Top-level connector documentation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/formats",children:"Supported data formats"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);