"use strict";(self.webpackChunkfeldera_docs=self.webpackChunkfeldera_docs||[]).push([[8418],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(96540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}},51668:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"operations/guide","title":"Troubleshooting","description":"This guide covers issues Feldera Enterprise users and operators might run into in production, and steps to remedy them.","source":"@site/docs/operations/guide.md","sourceDirName":"operations","slug":"/operations/guide","permalink":"/operations/guide","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Sidecar Containers","permalink":"/pipelines/sidecar"},"next":{"title":"Memory Usage","permalink":"/operations/memory"}}');var r=s(74848),t=s(28453);const o={},l="Troubleshooting",a={},c=[{value:"Pipelines with no input produce no outputs",id:"pipelines-with-no-input-produce-no-outputs",level:2},{value:"Diagnosing Performance Issues",id:"diagnosing-performance-issues",level:2},{value:"Common Error Messages",id:"common-error-messages",level:2},{value:"Delta Lake Connection Errors",id:"delta-lake-connection-errors",level:3},{value:"Out-of-Memory Errors",id:"out-of-memory-errors",level:3},{value:"Out-of-storage Errors",id:"out-of-storage-errors",level:3},{value:"Kubernetes evictions",id:"kubernetes-evictions",level:3},{value:"Rust Compilation Errors",id:"rust-compilation-errors",level:3},{value:"Uncommon Problems",id:"uncommon-problems",level:2},{value:"Lost or accidentally deleted the Feldera Control-Plane PostgreSQL database",id:"lost-or-accidentally-deleted-the-feldera-control-plane-postgresql-database",level:3},{value:"Expand existing pipeline storage",id:"expand-existing-pipeline-storage",level:2},{value:"Steps",id:"steps",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"troubleshooting",children:"Troubleshooting"})}),"\n",(0,r.jsx)(n.p,{children:"This guide covers issues Feldera Enterprise users and operators might run into in production, and steps to remedy them."}),"\n",(0,r.jsx)(n.h2,{id:"pipelines-with-no-input-produce-no-outputs",children:"Pipelines with no input produce no outputs"}),"\n",(0,r.jsxs)(n.p,{children:["Today the progress of a pipeline is mediated by the input connectors.\nA pipeline without any input connectors will actually produce no\noutputs.  In consequence, a SQL program that contains no tables and\nwhich does not call the ",(0,r.jsx)(n.code,{children:"NOW()"})," function will never produce an output."]}),"\n",(0,r.jsx)(n.p,{children:"Unfortunately this makes it impossible to run simple SQL testing\ncode such as:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW V AS SELECT 1 + 2;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The workaround this limitation is to have at least one table in each\nSQL program; inserting a row in this table will trigger the production\nof an output.  You can use the ",(0,r.jsx)(n.a,{href:"/connectors/sources/datagen",children:"datagen\nconnector"})," to populate this table:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE T(c BOOLEAN) WITH (\n  \'connectors\' = \'[{\n    "name": "dummy",\n    "transport": {\n      "name": "datagen",\n      "config": {\n        "plan": [{\n          "limit": 1\n        }]\n      }\n    }\n  }]\'\n);\n\nCREATE MATERIALIZED VIEW V AS SELECT 1 + 2 FROM T;\n'})}),"\n",(0,r.jsx)(n.h2,{id:"diagnosing-performance-issues",children:"Diagnosing Performance Issues"}),"\n",(0,r.jsx)(n.p,{children:"When investigating pipeline performance, Feldera support will typically request a\nsupport-bundle. The bundle can be downloaded from your installation with one of\nthe following methods:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"support-bundle"})," ",(0,r.jsx)(n.a,{href:"/interface/cli",children:"fda command"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fda support-bundle affected-pipeline-name\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["the ",(0,r.jsx)(n.code,{children:"support_bundle"})," ",(0,r.jsx)(n.a,{href:"https://docs.feldera.com/python/examples.html#retrieve-a-support-bundle-for-a-pipeline",children:"function in the Python SDK"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"the web-console has a button to download the bundle for a pipeline"}),"\n",(0,r.jsxs)(n.li,{children:["or the ",(0,r.jsx)(n.code,{children:"support_bundle"})," ",(0,r.jsx)(n.a,{href:"/api/download-support-bundle",children:"endpoint in the REST API"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The support bundle has the following content:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pipeline Logs"}),": for warnings and errors from the ",(0,r.jsx)(n.a,{href:"/api/stream-pipeline-logs",children:"logs"})," endpoint."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pipeline Configuration"}),": the ",(0,r.jsx)(n.a,{href:"/api/get-pipeline",children:"pipeline configuration"}),", including the SQL code and connector settings."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pipeline Metrics"}),": from the ",(0,r.jsx)(n.a,{href:"/api/get-pipeline-metrics",children:"pipeline metrics"})," endpoint."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint Stats"}),": from the ",(0,r.jsx)(n.a,{href:"/api/get-pipeline-stats",children:"stats"})," endpoint."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Circuit Profile"}),": from the ",(0,r.jsx)(n.a,{href:"/api/get-performance-profile",children:"circuit profile"})," endpoint."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Heap Profile"}),": from ",(0,r.jsx)(n.a,{href:"/api/get-heap-profile",children:"heap usage"})," endpoint."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"common-error-messages",children:"Common Error Messages"}),"\n",(0,r.jsx)(n.h3,{id:"delta-lake-connection-errors",children:"Delta Lake Connection Errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Error"}),": ",(0,r.jsx)(n.code,{children:"Table metadata is invalid: Number of checkpoint files '0' is not equal to number of checkpoint metadata parts 'None'"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": This usually happens when the Delta Table uses features unsupported by ",(0,r.jsx)(n.code,{children:"delta-rs"}),' like liquid clustering or deletion vectors. Check the table properties and set the checkpoint policy to "classic":']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE my_table SET TBLPROPERTIES (\n  'checkpointPolicy' = 'classic'\n)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"out-of-memory-errors",children:"Out-of-Memory Errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Error"}),": ",(0,r.jsx)(n.code,{children:"The pipeline container has restarted. This was likely caused by an Out-Of-Memory (OOM) crash."})]}),"\n",(0,r.jsx)(n.p,{children:"Feldera runs each pipeline in a separate container with configurable memory limits. Here are some knobs to\ncontrol memory usage:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Adjust the pipeline\u2019s memory reservation and limit:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"resources": {\n    "memory_mb_min": 32000,\n    "memory_mb_max": 32000\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Throttle the amount of records buffered by the connector using the ",(0,r.jsx)(n.a,{href:"https://docs.feldera.com/connectors/#generic-attributes",children:(0,r.jsx)(n.code,{children:"max_queued_records"})})," setting:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"max_queued_records": 100000\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Ensure that storage is enabled (it's on by default):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"storage": {\n    "backend": {\n      "name": "default"\n    },\n    "min_storage_bytes": null,\n    "compression": "default",\n    "cache_mib": null\n},\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Optimize your SQL queries to avoid expensive\ncross-products. Use functions like\n",(0,r.jsx)(n.a,{href:"https://docs.feldera.com/sql/datetime/#now",children:"NOW()"})," sparingly on large relations."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"out-of-storage-errors",children:"Out-of-storage Errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Error"}),": The pipeline logs contain messages like:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"DBSP error: runtime error: One or more worker threads terminated unexpectedly\nworker thread 0 panicked\npanic message: called `Result::unwrap()` on an `Err` value: StdIo(StorageFull)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Increase pipeline storage capacity"]}),"\n",(0,r.jsxs)(n.p,{children:["In the Enterprise edition, Feldera runs each pipeline in a separate pod and, by\ndefault, attaches PVC volumes for storage. The default volume size is 30 GB,\nand if your pipelines are encountering ",(0,r.jsx)(n.code,{children:"StorageFull"})," errors, you should\nexplicitly request larger volumes for each pipeline:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"resources": {\n    "storage_mb_max": 128000\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"kubernetes-evictions",children:"Kubernetes evictions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Error"}),": the pipeline becomes ",(0,r.jsx)(n.code,{children:"UNAVAILABLE"})," with no errors in the logs."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": configure resource reservations and limits for the Pipeline."]}),"\n",(0,r.jsx)(n.p,{children:"Kubernetes may evict Pipeline pods under node resource pressure. To confirm, run:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"kubectl describe pipeline-<pipeline-id>-0\n"})}),"\n",(0,r.jsx)(n.p,{children:"and look for"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Status: Failed\nReason: Evicted\n"})}),"\n",(0,r.jsx)(n.p,{children:"You can also view the eviction event in your cluster monitoring stack (e.g. Datadog)."}),"\n",(0,r.jsxs)(n.p,{children:["Evictions typically happen only when running Feldera in shared Kubernetes\nclusters. The pods to evict are determined by ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/configure-pod-container/quality-service-pod/",children:"Kubernetes Quality-of-Service\nclasses"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["By default, Feldera Pipelines do not reserve any CPU or memory resources, which\nputs them in the ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/workloads/pods/pod-qos/#besteffort",children:(0,r.jsx)(n.code,{children:"BestEffort"})})," priority class,\nmaking them eviction candidates. To raise their priority:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/workloads/pods/pod-qos/#burstable",children:(0,r.jsx)(n.code,{children:"Burstable"})})," class: reserve a minimum amount of memory and CPU:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"resources": {\n    "cpu_cores_min": 16,\n    "memory_mb_min": 32000,\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/workloads/pods/pod-qos/#guaranteed",children:(0,r.jsx)(n.code,{children:"Guaranteed"})})," class: set minimum and maximum resources to the same value, for memory and CPU:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"resources": {\n    "cpu_cores_min": 16,\n    "cpu_cores_max": 16,\n    "memory_mb_min": 32000,\n    "memory_mb_max": 32000,\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"rust-compilation-errors",children:"Rust Compilation Errors"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Error"}),": ",(0,r.jsx)(n.code,{children:"No space left on device"})," during Rust compilation"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Ensure the compiler-server has sufficient disk space (20Gib by default, configured via the ",(0,r.jsx)(n.code,{children:"compilerPvcStorageSize"})," value in the Helm chart)."]}),"\n",(0,r.jsx)(n.h2,{id:"uncommon-problems",children:"Uncommon Problems"}),"\n",(0,r.jsx)(n.h3,{id:"lost-or-accidentally-deleted-the-feldera-control-plane-postgresql-database",children:"Lost or accidentally deleted the Feldera Control-Plane PostgreSQL database"}),"\n",(0,r.jsx)(n.p,{children:"Feldera tracks state about pipelines inside a PostgreSQL database. If for\nsome reason the state in this database is ever lost or otherwise can not be\nrecovered, and the feldera instance had running pipelines at the time, a\nmanual intervention may be necessary to clean-up the leftover pods.\nIts not possible to reinstantiate these leftover (orphaned) pipelines,\ntherefore the Kubernetes objects backing these pipelines should be manually\nremoved."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Identify any stale pipelines in the feldera namespace\n(e.g., by running ",(0,r.jsx)(n.code,{children:"kubectl get pods -n $NS"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"For each pipeline delete the k8s definitions that feldera\ncreated for it: Statefulset, Service, ConfigMap, Pod and PVC."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Here is an example script that would clean up a stale pipeline. Note: it is generally\nnot enough to just delete the pod since the existing statefulset will try to re-create\nit."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"NAMESPACE=feldera-ns\nPOD=pipeline-019a7c1d-6a0c-7923-afd7-0125fe589356-0\nNAME=pipeline-019a7c1d-6a0c-7923-afd7-0125fe589356\nPVC=pipeline-019a7c1d-6a0c-7923-afd7-0125fe589356-storage-pipeline-019a7c1d-6a0c-7923-afd7-0125fe589356-0\n\n# Ensure you have the permissions to perform the delete operations\nkubectl auth can-i delete sts -n $NAMESPACE\nkubectl auth can-i delete service -n $NAMESPACE\nkubectl auth can-i delete configmap -n $NAMESPACE\nkubectl auth can-i delete pod -n $NAMESPACE\nkubectl auth can-i delete pvc -n $NAMESPACE\n\n# Delete the k8s objects manually\nkubectl delete sts -n $NAMESPACE $NAME\nkubectl delete service -n $NAMESPACE $NAME\nkubectl delete configmap -n $NAMESPACE $NAME\nkubectl delete pod -n $NAMESPACE $POD\nkubectl delete pvc -n $NAMESPACE $PVC\n"})}),"\n",(0,r.jsx)(n.h2,{id:"expand-existing-pipeline-storage",children:"Expand existing pipeline storage"}),"\n",(0,r.jsx)(n.admonition,{title:"Advanced Enterprise-only feature",type:"note",children:(0,r.jsx)(n.p,{children:"This guide is only applicable to the Feldera Enterprise Edition and is\nfor advanced users as it details out-of-band steps that make certain\nassumptions on implementation details of Feldera. As a consequence,\nthese steps might be subject to change in the future. They are\nwritten with only single-host pipelines in mind."})}),"\n",(0,r.jsxs)(n.p,{children:["Choosing a larger storage without preserving existing state can be done\nby clearing the storage, followed by increasing the runtime configuration's\n",(0,r.jsx)(n.code,{children:"resources.storage_mb_max"}),". However, this field cannot be edited with uncleared\nstorage (i.e., while preserving existing state). Currently, Feldera does not\nhave the feature to expand existing storage. It is however possible to do it\nout-of-band by directly interacting with the underlying Kubernetes PVC.\nThis is only possible if its storage class allows volume expansion."]}),"\n",(0,r.jsxs)(n.p,{children:["This out-of-band action will result in a discrepancy between what the runtime\nconfiguration ",(0,r.jsx)(n.code,{children:"resources.storage_mb_max"})," states and the actual size of the\nstorage. Be aware that clearing storage afterward will delete the PVC that\nwas changed out-of-band, thereby undoing the storage expansion."]}),"\n",(0,r.jsx)(n.h3,{id:"steps",children:"Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Note down the ",(0,r.jsx)(n.code,{children:"<pipeline-id>"})," of the pipeline\n(from the Web Console: Open pipeline -> Tab: Performance -> Pipeline ID button)."]}),"\n",(0,r.jsx)(n.p,{children:"These environment variables will be used in the following steps:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# TODO: change to your own situation\nNAMESPACE=feldera\nPIPELINE_PVC=pipeline-<pipeline-id>-storage-pipeline-<pipeline-id>-0\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check the PVC of the pipeline:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"kubectl get pvc -n $NAMESPACE $PIPELINE_PVC\n"})}),"\n",(0,r.jsxs)(n.p,{children:["... which for example outputs (",(0,r.jsx)(n.code,{children:"resources.storage_mb_max"})," is set to 25000 in this example):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NAME            STATUS   VOLUME    CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE\npipeline-....   Bound    pvc-...   24Gi       RWO            gp3            <unset>                 21s\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The storage class is ",(0,r.jsx)(n.code,{children:"gp3"})," in this example."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check the storage class:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"kubectl get sc gp3\n"})}),"\n",(0,r.jsx)(n.p,{children:"... which for example outputs:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NAME   PROVISIONER       RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE\ngp3    ebs.csi.aws.com   Delete          WaitForFirstConsumer   true                   10d\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The storage class must support volume expansion (above: ",(0,r.jsx)(n.code,{children:"ALLOWVOLUMEEXPANSION"}),")\nin order to continue with the next step. If it does not, you can potentially enable\nit for the storage class via:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"kubectl patch sc gp3 -p '{\"allowVolumeExpansion\": true}'\n"})}),"\n",(0,r.jsxs)(n.p,{children:["... followed by checking this is the case by doing again ",(0,r.jsx)(n.code,{children:"kubectl get sc gp3"}),"\nand looking under ",(0,r.jsx)(n.code,{children:"ALLOWVOLUMEEXPANSION"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Patch the PVC of the pipeline with a higher storage request\n(in this example, increasing ",(0,r.jsx)(n.code,{children:"25G"})," to ",(0,r.jsx)(n.code,{children:"50G"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'kubectl patch pvc -n $NAMESPACE $PIPELINE_PVC \\\n    -p \'{"spec":{"resources":{"requests":{"storage":"50G"}}}}\'\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Note: it is not possible to patch ",(0,r.jsx)(n.code,{children:"spec.resources.limits.storage"}),",\nas such it will be lower than ",(0,r.jsx)(n.code,{children:"spec.resources.requests.storage"})," afterward.\nIrrespectively, on AWS it does expand the storage."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Wait for the PVC resizing to take effect:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"kubectl get pvc -n $NAMESPACE $PIPELINE_PVC\n"})}),"\n",(0,r.jsx)(n.p,{children:"... which for example eventually outputs (it can take seconds or minutes):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NAME            STATUS   VOLUME    CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE\npipeline-....   Bound    pvc-...   47Gi       RWO            gp3            <unset>                 5m44s\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If it takes longer than expected, you can also debug\nusing ",(0,r.jsx)(n.code,{children:"kubectl describe pvc -n $NAMESPACE $PIPELINE_PVC"}),"\nto find out what is going on with the PVC."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["It depends on the storage provisioner backing the storage class whether it accepts the\nPVC modification, and how long it takes for it to be applied. Additionally, storage\nprovisioners can limit how often you can modify a PVC in a certain time window.\nDoing multiple expansions of the same PVC in quick succession might stop working at\nsome point, as is the case for AWS. Consult your cloud provider documentation to learn more\n(e.g., ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/ebs/latest/userguide/ebs-modify-volume.html#elastic-volumes-considerations",children:"AWS"}),")."]})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);